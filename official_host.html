<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ממשק מפעיל רשמי</title>
  <link rel="stylesheet" href="styles.css">
  <script src="config.js"></script>
</head>
<body>
  <h1>ממשק מפעיל רשמי</h1>
  <button id="join-btn">הצטרף כמצלמה ומיקרופון</button>
  <div id="local-camera" style="width:100%; height:calc(100vh - 50px); background:#000;"></div>

  <script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.14.0.js"></script>
  <script>
    const client    = AgoraRTC.createClient({ mode: 'rtc', codec: 'vp8' });
    const params    = new URLSearchParams(location.search);
    const CHANNEL   = params.get('channel');
    const UID       = Number(params.get('uid'));
    let micTrack, cameraTrack;

    document.getElementById('join-btn').onclick = async () => {
      // הצטרפות לערוץ
      await client.join(AGORA_APP_ID, CHANNEL, AGORA_TOKEN, UID);

      // יצירת מיקרופון + מצלמה
      [micTrack, cameraTrack] = await AgoraRTC.createMicrophoneAndCameraTracks();

      // פרסום שני הטרַקסים
      await client.publish([micTrack, cameraTrack]);

      // תצוגת המצלמה המקומית
      cameraTrack.play('local-camera');
    };
  </script>
</body>
</html>
