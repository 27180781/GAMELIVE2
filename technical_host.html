<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ממשק מפעיל טכני</title>
  <link rel="stylesheet" href="styles.css">
  <script src="config.js"></script>
</head>
<body>
  <h1>ממשק מפעיל טכני</h1>
  <button id="join-btn">הצטרף לשיתוף מסך ומיקרופון</button>
  <div id="local-screen" style="width:100%; height:calc(100vh - 50px); background:#000;"></div>

  <script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.14.0.js"></script>
  <script>
    const client    = AgoraRTC.createClient({ mode: 'rtc', codec: 'vp8' });
    const params    = new URLSearchParams(location.search);
    const CHANNEL   = params.get('channel');
    const UID       = Number(params.get('uid'));
    let micTrack, screenTrack;

    document.getElementById('join-btn').onclick = async () => {
      // הצטרפות לערוץ
      await client.join(AGORA_APP_ID, CHANNEL, AGORA_TOKEN, UID);

      // ייצוא מסך עם סאונד
      screenTrack = await AgoraRTC.createScreenVideoTrack({
        encoderConfig: '1080p_2',
        withAudio: true
      });

      // יצירת מיקרופון (למיקרופון בלבד)
      micTrack = (await AgoraRTC.createMicrophoneAndCameraTracks())[0];

      // פרסום שיתוף מסך + מיקרופון
      await client.publish([screenTrack, micTrack]);

      // תצוגת שיתוף המסך המקומית
      screenTrack.play('local-screen');
    };
  </script>
</body>
</html>
